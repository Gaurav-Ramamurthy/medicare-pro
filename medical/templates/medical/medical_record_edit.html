{% extends "core/base.html" %}
{% load static %}

{% block title %}Edit Medical Record{% endblock %}

{% block extra_css %}
<style>
.container {
  max-width: 800px;
  margin: 32px auto;
  padding: 0 16px;
}
.card {
  background: #fff;
  border-radius: 14px;
  padding: 24px;
  box-shadow: 0 4px 18px rgba(0,188,212,0.08);
}
h2 {
  color: #00695c;
  margin-bottom: 4px;
}
.subtitle {
  color: #546e7a;
  margin-bottom: 16px;
}
label {
  font-weight: 700;
  color: #37474f;
  display: block;
  margin-bottom: 8px;
}
textarea, input[type="text"], input[type="file"] {
  width: 100%;
  padding: 12px;
  border: 2px solid #b2ebf2;
  border-radius: 8px;
  font-size: 1rem;
  margin-bottom: 16px;
  transition: border .2s;
}
textarea:focus, input[type="text"]:focus, input[type="file"]:focus {
  border-color: #00bcd4;
  outline: none;
  box-shadow: 0 0 0 3px rgba(0,188,212,0.1);
}
.btn, button, input[type="submit"] {
  background: #00bcd4;
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 10px 20px;
  font-weight: 600;
  cursor: pointer;
  text-decoration: none;
  display: inline-block;
}
.btn:hover {
  background: #0097a7;
}
.btn-danger {
  background: #ef4444;
}
.btn-danger:hover {
  background: #dc2626;
}
.actions {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  margin-top: 8px;
}
</style>
{% endblock %}

{% block content %}
<div class="container">
  <div class="card">
    <h2>Edit Medical Record</h2>
    <p class="subtitle">
      Patient: {{ patient.first_name }} {{ patient.last_name }}
    </p>

    <hr style="border:none;border-top:2px solid #e0f2f1;margin:16px 0;">

    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}

      <label for="id_file_description">üìù File/PDF Description</label>
      <input type="text"
             name="file_description"
             id="id_file_description"
             value="{{ record.file_description }}"
             placeholder="e.g., Blood Test Report - Nov 2025">

      <label for="id_attachment">üìé Replace / Upload File (optional)</label>
      <input type="file" name="attachment" id="id_attachment"
             accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.txt">
      {% if record.attachment %}
        <p style="color:#00838f;margin-top:-10px;margin-bottom:16px;">
          Current file:
          <a href="{{ record.attachment.url }}" target="_blank">
            {{ record.attachment.name|slice:"16:" }}
          </a>
        </p>
      {% endif %}

      <label for="id_content">Additional Notes</label>
      <textarea name="content" id="id_content" rows="6"
                placeholder="Update medical notes...">{{ record.content }}</textarea>

      <div class="actions">
        <button type="submit" class="btn">Update Record</button>
        <a href="{% url 'patient_medical_records' patient.pk %}" class="btn btn-danger">
          Cancel
        </a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
